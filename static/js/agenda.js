var activities = {
    "AA hb": {
        "code": "AA hb",
        "description": "huisbezoek aud. ass.",
        "color": "#ffffff"
    },
    "AVP": {
        "code": "AVP",
        "description": "auditieve verwerkingsproblematiek",
        "color": "#ffff80"
    },
    "AVP gspr": {
        "code": "AVP gspr",
        "description": "adviesgesprek na AVP",
        "color": "#ffff80"
    },
    "AvD": {
        "code": "AvD",
        "description": "Audioloog van dienst",
        "color": "#d0d0f0"
    },
    "BCD": {
        "code": "BCD",
        "description": "BCD, Baha",
        "color": "#008000"
    },
    "BERA kind": {
        "code": "BERA kind",
        "description": "BERA/uitval NGS",
        "color": "#c0c0c0"
    },
    "BERA volw": {
        "code": "BERA volw",
        "description": "BERA bij volwassene",
        "color": "#c0c0c0"
    },
    "CHT": {
        "code": "CHT",
        "description": "controle htt volw.",
        "color": "#8080ff"
    },
    "CHT solo": {
        "code": "CHT solo",
        "description": "controle solo + evt CHT",
        "color": "#8080ff"
    },
    "FAN": {
        "code": "FAN",
        "description": "fonologische analyse",
        "color": "#ffff80"
    },
    "Feestdagen": {
        "code": "Feestdagen",
        "description": "Feestdagen",
        "color": "#8080ff"
    },
    "Fiets": {
        "code": "Fiets",
        "description": "Dienstfiets mee",
        "color": "#6bc7fe"
    },
    "Jarig": {
        "code": "Jarig",
        "description": "Jarig",
        "color": "#ff8000"
    },
    "KA": {
        "code": "KA",
        "description": "kinderaudiometrie 3-7 jaar en/of  indicatie T/S",
        "color": "#80ffff"
    },
    "KA-c": {
        "code": "KA-c",
        "description": "kinderaudiometrie 3-7 jaar en/of  indicatie T/S",
        "color": "#9ddfff"
    },
    "KA-n": {
        "code": "KA-n",
        "description": "kinderaudiometrie 3-7 jaar en/of  indicatie T/S",
        "color": "#4aa5ff"
    },
    "LO": {
        "code": "LO",
        "description": "logopedisch onderzoek",
        "color": "#ffff80"
    },
    "LO gspr": {
        "code": "LO gspr",
        "description": "adviesgesprek na LO",
        "color": "#ffff80"
    },
    "LO hb": {
        "code": "LO hb",
        "description": "huisbezoek logopedist",
        "color": "#ffff80"
    },
    "ORtijd": {
        "code": "ORtijd",
        "description": "OR tijd",
        "color": "#408080"
    },
    "PO": {
        "code": "PO",
        "description": "psychologisch onderzoek",
        "color": "#ff8040"
    },
    "PO gspr": {
        "code": "PO gspr",
        "description": "adviesgesprek na PO",
        "color": "#ff8040"
    },
    "SGB": {
        "code": "SGB",
        "description": "SGB tijd",
        "color": "#408080"
    },
    "VA": {
        "code": "VA",
        "description": "volwassenaudiometrie \u003e7",
        "color": "#ffffff"
    },
    "VA-Vest": {
        "code": "VA-Vest",
        "description": "Audiometrie voor vestibulair",
        "color": "#808000"
    },
    "VA/KA+CHT kind": {
        "code": "VA/KA+CHT kind",
        "description": "audiometrie + contr htt bij een kind",
        "color": "#ff80c0"
    },
    "VA/KA+CHT+solo": {
        "code": "VA/KA+CHT+solo",
        "description": "audiometrie + contr htt + solo",
        "color": "#ff80ff"
    },
    "VO": {
        "code": "VO",
        "description": "vestibulair onderzoek",
        "color": "#808000"
    },
    "Verlofaanvraag in behandeling": {
        "code": "Verlofaanvraag in behandeling",
        "description": "Verlofaanvraag in behandeling",
        "color": "#ffff00"
    },
    "Xterna": {
        "code": "Xterna",
        "description": "Xterna",
        "color": "#408080"
    },
    "brieventijd": {
        "code": "brieventijd",
        "description": "brieventijd",
        "color": "#408080"
    },
    "ci": {
        "code": "ci",
        "description": "controle CI",
        "color": "#ff00ff"
    },
    "clienttijd": {
        "code": "clienttijd",
        "description": "Clientgebonden werktijd",
        "color": "#f0d0c0"
    },
    "combi": {
        "code": "combi",
        "description": "combi spreekuur",
        "color": "#ff8040"
    },
    "dkg-ew-vra": {
        "code": "dkg-ew-vra",
        "description": "ewing / vra",
        "color": "#ffffff"
    },
    "ewing": {
        "code": "ewing",
        "description": "ewing onderzoek",
        "color": "#80ffff"
    },
    "gbk": {
        "code": "gbk",
        "description": "groepsbijeenkomst",
        "color": "#ffae5e"
    },
    "gsp": {
        "code": "gsp",
        "description": "gesprek",
        "color": "#ffffff"
    },
    "ling": {
        "code": "ling",
        "description": "linguistisch onderzoek",
        "color": "#ffff80"
    },
    "ling gspr": {
        "code": "ling gspr",
        "description": "adviesgesprek na ling",
        "color": "#ffff80"
    },
    "mw-gsp": {
        "code": "mw-gsp",
        "description": "gesprek maatsch. werk",
        "color": "#ff0080"
    },
    "mw-hb": {
        "code": "mw-hb",
        "description": "huisbezoek maatsch. werk",
        "color": "#ff0080"
    },
    "mw-sb": {
        "code": "mw-sb",
        "description": "schoolbezoek maatsch. werk",
        "color": "#ff0080"
    },
    "oa": {
        "code": "oa",
        "description": "onderzoek audioloog",
        "color": "#00ff00"
    },
    "onderzoek Ede": {
        "code": "onderzoek Ede",
        "description": "alle onderzoeken op locatie Ede",
        "color": "#a0a0a0"
    },
    "onderzoek PG school": {
        "code": "onderzoek PG school",
        "description": "audiometrie op PG school",
        "color": "#ff80c0"
    },
    "onderzoek Poli": {
        "code": "onderzoek Poli",
        "description": "audiometrie op poli",
        "color": "#ff80c0"
    },
    "overhead": {
        "code": "overhead",
        "description": "Niet-clientgebonden werktijd",
        "color": "#d0d0f0"
    },
    "overleg": {
        "code": "overleg",
        "description": "overleg",
        "color": "#408080"
    },
    "poli": {
        "code": "poli",
        "description": "poli KNO",
        "color": "#408080"
    },
    "roostervrij": {
        "code": "roostervrij",
        "description": "Roostervrij",
        "color": "#c0e0c0"
    },
    "spoedplek": {
        "code": "spoedplek",
        "description": "spoedplek",
        "color": "#ff0000"
    },
    "stempoli": {
        "code": "stempoli",
        "description": "stemonderzoeken op poli KNO",
        "color": "#a0a0a0"
    },
    "tc": {
        "code": "tc",
        "description": "telefonisch consult",
        "color": "#ffffff"
    },
    "tinn": {
        "code": "tinn",
        "description": "tinnitus spreekuur",
        "color": "#ff0080"
    },
    "uitwerktijd": {
        "code": "uitwerktijd",
        "description": "uitwerken van een onderzoek",
        "color": "#408080"
    },
    "vra": {
        "code": "vra",
        "description": "vra onderzoek",
        "color": "#80ffff"
    },
    "vrij-opgenomen": {
        "code": "vrij-opgenomen",
        "description": "Vrij opgenomen",
        "color": "#80f080"
    },
    "xtraT": {
        "code": "xtraT",
        "description": "Extra tijd",
        "color": "#408080"
    },
    "ziek": {
        "code": "ziek",
        "description": "Ziek",
        "color": "#f08080"
    }
}

var items = {
	groups: {
		g1: {
			pattern: 'daily',
			begin: '2014-01-01',
			end: '2014-01-01',
			activity: 'brief' 
		},
		g2: {
			pattern: 'weekly',
			begin: '2014-01-01',
			end: '2014-02-01',
			activity: 'afov'
		}
	},
	appointments: {
		ACTB_12345: {
			type: 'client-meeting',
			"begin": '10:00',
			end: '12:00',
			group: 'g1'
		}
		
	},
    "dates": [
        {
            "date": "2014-07-30",
            "resources": [
                {
                    "key": "05",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-09A00285",
                            "activities": [
                                "KA-c",
                                "KA-n"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-13A01677",
                            "activities": [
                                "KA-c",
                                "KA-n"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        }
                    ],
                    "items": ['ACTB_12345']
                },
                {
                    "key": "1.06",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-11A01001",
                            "activities": [
                                "CHT",
                                "VA"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-11A01000",
                            "activities": [
                                "CHT",
                                "VA"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "1.04",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-11A01230",
                            "activities": [
                                "BERA kind",
                                "BERA volw"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-11A01229",
                            "activities": [
                                "BERA kind",
                                "BERA volw"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        }
                    ],
                    "items": ['ACTB_12345']
                },
                {
                    "key": "AR",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-12A01001",
                            "activities": [
                                "VA"
                            ],
                            "begin": "13:00",
                            "end": "16:45"
                        },
                        {
                            "key": "PJJG-12A01000",
                            "activities": [
                                "VA"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "EAD",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-09A00733",
                            "activities": [
                                "overleg"
                            ],
                            "begin": "13:00",
                            "end": "14:00"
                        },
                        {
                            "key": "PJJG-09A00734",
                            "activities": [
                                "CHT"
                            ],
                            "begin": "14:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-09A00735",
                            "activities": [
                                "VA"
                            ],
                            "begin": "11:15",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-09A00088",
                            "activities": [
                                "CHT"
                            ],
                            "begin": "11:15",
                            "end": "12:15"
                        },
                        {
                            "key": "PJJG-09A00092",
                            "activities": [
                                "poli"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "03",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-09A00283",
                            "activities": [
                                "CHT",
                                "VA",
                                "VA-Vest",
                                "oa"
                            ],
                            "begin": "08:00",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "dir",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-10A00494",
                            "activities": [
                                "overhead"
                            ],
                            "begin": "08:00",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "MvdG",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-10A00617",
                            "activities": [
                                "overhead"
                            ],
                            "begin": "08:45",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "00",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-13A02496",
                            "activities": [
                                "PO"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-11A00974",
                            "activities": [
                                "LO"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "MV",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-13A02524",
                            "activities": [
                                "overhead"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "E03",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-14E00018",
                            "activities": [
                                "Baha-C",
                                "Baha-n",
                                "CHT",
                                "KA-n",
                                "VA",
                                "VA-kort",
                                "oa",
                                "vra"
                            ],
                            "begin": "08:00",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "1.08",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-09A00289",
                            "activities": [
                                "CHT",
                                "VA"
                            ],
                            "begin": "08:45",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "IM",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-13A02156",
                            "activities": [
                                "combi"
                            ],
                            "begin": "09:00",
                            "end": "11:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "LK",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-14E00065",
                            "activities": [
                                "Baha-C"
                            ],
                            "begin": "10:15",
                            "end": "11:00"
                        },
                        {
                            "key": "PJJG-14E00069",
                            "activities": [
                                "Baha-n"
                            ],
                            "begin": "15:15",
                            "end": "16:30"
                        },
                        {
                            "key": "PJJG-14E00068",
                            "activities": [
                                "Baha-C"
                            ],
                            "begin": "14:15",
                            "end": "15:00"
                        },
                        {
                            "key": "PJJG-14E00064",
                            "activities": [
                                "Baha-C"
                            ],
                            "begin": "09:15",
                            "end": "10:00"
                        },
                        {
                            "key": "PJJG-14E00063",
                            "activities": [
                                "VA-kort"
                            ],
                            "begin": "08:45",
                            "end": "09:15"
                        },
                        {
                            "key": "PJJG-14E00067",
                            "activities": [
                                "VA"
                            ],
                            "begin": "13:00",
                            "end": "14:15"
                        },
                        {
                            "key": "PJJG-14E00066",
                            "activities": [
                                "Baha-n"
                            ],
                            "begin": "11:00",
                            "end": "12:15"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "EB",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-09A00069",
                            "activities": [
                                "vra"
                            ],
                            "begin": "10:00",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "1.01",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-11A00982",
                            "activities": [
                                "LO",
                                "ling"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-11A02170",
                            "activities": [
                                "ling"
                            ],
                            "begin": "09:30",
                            "end": "11:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "CSW",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-13A00748",
                            "activities": [
                                "ewing"
                            ],
                            "begin": "13:00",
                            "end": "15:30"
                        },
                        {
                            "key": "PJJG-13A00755",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "15:30",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-13A00753",
                            "activities": [
                                "LO"
                            ],
                            "begin": "08:45",
                            "end": "10:45"
                        },
                        {
                            "key": "PJJG-13A00754",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "10:45",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "E01",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-14E00001",
                            "activities": [
                                "LO",
                                "PO",
                                "combi"
                            ],
                            "begin": "08:00",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "MH",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-11A01159",
                            "activities": [
                                "overhead"
                            ],
                            "begin": "15:30",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-09A00148",
                            "activities": [
                                "poli"
                            ],
                            "begin": "08:00",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-11A01158",
                            "activities": [
                                "CHT"
                            ],
                            "begin": "13:30",
                            "end": "15:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "E04",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-14E00019",
                            "activities": [
                                "Baha-C",
                                "Baha-n",
                                "CHT",
                                "KA-n",
                                "VA",
                                "VA-kort",
                                "oa",
                                "vra"
                            ],
                            "begin": "08:00",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "JSP",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-09A00740",
                            "activities": [
                                "poli"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-09A00095",
                            "activities": [
                                "overleg"
                            ],
                            "begin": "13:00",
                            "end": "14:00"
                        },
                        {
                            "key": "PJJG-09A00096",
                            "activities": [
                                "CHT"
                            ],
                            "begin": "14:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "02",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-09A00282",
                            "activities": [
                                "oa"
                            ],
                            "begin": "08:00",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "Vest",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-09A00330",
                            "activities": [
                                "VO"
                            ],
                            "begin": "08:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "01",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-09A00396",
                            "activities": [
                                "KA",
                                "KA-c",
                                "KA-n",
                                "LO",
                                "ewing"
                            ],
                            "begin": "08:45",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "1.07",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-11A01010",
                            "activities": [
                                "VA"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-12A02299",
                            "activities": [
                                "LO"
                            ],
                            "begin": "08:45",
                            "end": "10:45"
                        },
                        {
                            "key": "PJJG-12A02300",
                            "activities": [
                                "VA"
                            ],
                            "begin": "11:15",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-11A00995",
                            "activities": [
                                "KA-c",
                                "KA-n",
                                "LO"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "IT",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-13A01391",
                            "activities": [
                                "KA-n"
                            ],
                            "begin": "13:00",
                            "end": "15:30"
                        },
                        {
                            "key": "PJJG-13A01390",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "10:45",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-13A01392",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "15:30",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-13A01346",
                            "activities": [
                                "LO"
                            ],
                            "begin": "08:45",
                            "end": "10:45"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "WG",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-09A00134",
                            "activities": [
                                "oa"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-09A00603",
                            "activities": [
                                "AvD"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "04",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-09A00284",
                            "activities": [
                                "CHT",
                                "VA",
                                "oa"
                            ],
                            "begin": "08:45",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "MdV",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-13A02151",
                            "activities": [
                                "combi"
                            ],
                            "begin": "09:00",
                            "end": "11:00"
                        },
                        {
                            "key": "PJJG-11A00909",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "16:15",
                            "end": "17:30"
                        },
                        {
                            "key": "PJJG-11A00900",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "08:00",
                            "end": "08:30"
                        },
                        {
                            "key": "PJJG-11A00908",
                            "activities": [
                                "KA-c"
                            ],
                            "begin": "15:30",
                            "end": "16:15"
                        },
                        {
                            "key": "PJJG-13A00749",
                            "activities": [
                                "ewing"
                            ],
                            "begin": "13:00",
                            "end": "15:30"
                        },
                        {
                            "key": "PJJG-13A02152",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "11:00",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "MW",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-11A01374",
                            "activities": [
                                "mw-gsp",
                                "tinn"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-11A01373",
                            "activities": [
                                "mw-gsp",
                                "tinn"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "WJA",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-12A01746",
                            "activities": [
                                "overhead"
                            ],
                            "begin": "11:15",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-12A01745",
                            "activities": [
                                "VA"
                            ],
                            "begin": "08:45",
                            "end": "11:15"
                        },
                        {
                            "key": "PJJG-12A01778",
                            "activities": [
                                "VA"
                            ],
                            "begin": "11:15",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "E02",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-14E00017",
                            "activities": [
                                "LO",
                                "PO",
                                "combi"
                            ],
                            "begin": "08:00",
                            "end": "17:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "HH",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-10A01831",
                            "activities": [
                                "AvD"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-13A00070",
                            "activities": [
                                "oa"
                            ],
                            "begin": "15:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-13A00069",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "13:00",
                            "end": "15:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "LJLK",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-11A00341",
                            "activities": [
                                "overleg"
                            ],
                            "begin": "13:00",
                            "end": "14:00"
                        },
                        {
                            "key": "PJJG-14A00652",
                            "activities": [
                                "CHT"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-14A00655",
                            "activities": [
                                "VA"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "MRK",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-11A00941",
                            "activities": [
                                "KA-n"
                            ],
                            "begin": "08:45",
                            "end": "11:15"
                        },
                        {
                            "key": "PJJG-11A00942",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "11:15",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-12A00065",
                            "activities": [
                                "LO"
                            ],
                            "begin": "13:00",
                            "end": "15:00"
                        },
                        {
                            "key": "PJJG-11A00940",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "07:30",
                            "end": "08:30"
                        },
                        {
                            "key": "PJJG-12A00066",
                            "activities": [
                                "brieventijd"
                            ],
                            "begin": "15:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "MZ",
                    "type": "person",
                    "schedule": [
                        {
                            "key": "PJJG-12A02197",
                            "activities": [
                                "ling"
                            ],
                            "begin": "13:30",
                            "end": "15:30"
                        },
                        {
                            "key": "PJJG-11A02092",
                            "activities": [
                                "ling"
                            ],
                            "begin": "09:30",
                            "end": "11:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "06",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-14A00722",
                            "activities": [
                                "PO"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        },
                        {
                            "key": "PJJG-11A02178",
                            "activities": [
                                "PO",
                                "combi"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        }
                    ],
                    "items": []
                },
                {
                    "key": "1.05",
                    "type": "room",
                    "schedule": [
                        {
                            "key": "PJJG-13A01407",
                            "activities": [
                                "VA"
                            ],
                            "begin": "08:45",
                            "end": "12:30"
                        },
                        {
                            "key": "PJJG-13A01408",
                            "activities": [
                                "VA"
                            ],
                            "begin": "13:00",
                            "end": "17:00"
                        }
                    ],
                    "items": []
                }
            ]
        }
    ]
};

var _rc = document.createElement("canvas");
_rc.width = 4;
_rc.height = 4;

var rasterCanvas = function(color) {
//	c.setDimensions({width: 4, height: 4});
    var ctx = _rc.getContext('2d');
	ctx.strokeWidth = 0.1;
	ctx.strokeStyle = color;
	ctx.beginPath();
	ctx.moveTo(0, 4);
	ctx.lineTo(4, 0);
	ctx.stroke();
	return _rc;
};

var labelWidth = 70;	
var colWidth = 50;
var rowHeight = 30;	
var calendarStartTime = '7:30'; // TODO: configureerbaar maken
var hours = [
	{time: 7.5, officeHours: false}, {time: 8, officeHours: true}, {time: 8.5, officeHours: true}, 
	{time: 9, officeHours: true}, {time: 9.5, officeHours: true}, {time: 10, officeHours: true},
	{time: 10.5, officeHours: true}, {time: 11, officeHours: true}, {time: 11.5, officeHours: true}, 
	{time: 12, officeHours: false}, {time: 12.5, officeHours: false}, {time: 13, officeHours: true}, 
	{time: 13.5, officeHours: true}, {time: 14, officeHours: true}, {time: 14.5, officeHours: true},
	{time: 15, officeHours: true}, {time: 15.5, officeHours: true}, {time: 16, officeHours: true},
	{time: 16.5, officeHours: true}, {time: 17, officeHours: true}, {time: 17.5, officeHours: true},
	{time: 18, officeHours: false}
];

reTime = /^([0-9]*)[:.]([0-9]*).*$/;

var hoursFromTimeString = function(time) {
	match = time.match(reTime);
	if (match == null) {
		return 0;
	}
	return parseInt(match[1]);
}

var minutesFromTimeString = function(time) {
	match = time.match(reTime);
	if (match == null) {
		return 0;
	}
	return parseInt(match[2]);				
}

var timeStringToMinutes = function(time) {
	var hours = hoursFromTimeString(time);
	var minutes = minutesFromTimeString(time);
	if (hours || minutes) {
		return minutes + (60 * hours);					
	}
	return 0;
};

var timeStringToY = function(time) {
	var minutes = timeStringToMinutes(time);
	var difference = minutes - timeStringToMinutes(calendarStartTime);
	return innerY + ((difference / 30) * rowHeight);
};

var colors = [];
colors.push('#8080ff');
var activityCodes = Object.keys(activities);

var colorFromActivities = function(itemActivities) {
	var color = '#8080ff';
	if (itemActivities.length > 0) {
		var activity = activities[itemActivities[0]];
		if (activity != undefined) {
			color = activity.color;
		}
	} 
	return color;
};


for (var i = 0; i < activityCodes.length; i++) {
	var color = activities[activityCodes[i]].color;
	if (colors.indexOf(color) == -1) {
		colors.push(color);
	} 
}

var afspraakVerplaatsen = function(evt) {
	// todo: gedeelte van deze code verplaatsen naar press (klikAfspraak)?
	var afspraak = evt.target
	if (afspraak.isDragged) {
		var deltaX = evt.stageX - afspraak.dragX;
		var deltaY = evt.stageY - afspraak.dragY;
		afspraak.x = afspraak.x + deltaX;
		afspraak.y = afspraak.y + deltaY;
		stage.update();
	}
	else {
		stage.setChildIndex(afspraak, stage.getNumChildren()-1);
		afspraak.isDragged = true;
		afspraak.dragStartX = afspraak.x;
		afspraak.dragStartY = afspraak.y;
	}
	afspraak.dragX = evt.stageX;
	afspraak.dragY = evt.stageY;
};

var afspraakVerplaatst = function(evt) {
	// todo: als de x- en y-coördinaat niet zijn gewijzigd,
	// roep dan afspraakTonen() aan.
	afspraak = evt.target;
	afspraak.isDragged = false;
	if ((afspraak.x != afspraak.dragStartX) || (afspraak.y != afspraak.dragStartY)) {
		alert("Afspraak verplaatst");
	}
	else {
		afspraakTonen(evt);
	}
};

var afspraakTonen = function(evt) {
	alert("Afspraak tonen");
};

var createColumn = function(resource, x, y, width, height) {
	var col = {
		"header": null,
		"roosters": [],
		"borders": [],
		"afspraken": []
	};

	// Kolom header
	col.header = new createjs.Text(resource.key, "14px Verdana", "black");
	col.header.x = x + 1.5;
	col.header.y = y;
	
	// Rooster items
	for (var s = 0; s < resource.schedule.length; s++) {
		var schedule = resource.schedule[s];
		var scheduleY = timeStringToY(schedule.begin) + 0.5;
		var scheduleHeight = timeStringToY(schedule.end) + 0.5 - scheduleY;

		r = new createjs.Shape();
		r.graphics
			.beginBitmapFill(rasterCanvas(colorFromActivities(schedule.activities)))
			.rect(x, scheduleY, width, scheduleHeight);
		col.roosters.push(r);

		var l = new createjs.Text(schedule.activities.join(), "11px Verdana", "#5a6d84");
		l.x = x + 2;
		l.y = scheduleY + 2;
		l.lineWidth = width - 2;
		l.mask = r;
		col.roosters.push(l);
	
	}
	
	// Borders
	var l = new createjs.Shape();
	l.graphics
		.setStrokeStyle(0.5)
		.beginStroke("black")
		.setStrokeDash([2, 3], 0)
		.moveTo(x, y)
		.lineTo(x, height)
		.endStroke();
	col.borders.push(l);
	
	//Afspraak items	
	for (var a = 0; a < resource.items.length; a++) {
		var appointment = {};
		appointment.key = resource.items[a];
		var part1 = items.appointments[appointment.key];
		var part2 = items.groups[part1.group];
		appointment.begin = part1.begin;   // TODO: timeslots (tijdvakken)
		appointment.end = part1.end;
		appointment.activity = part2.activity;
		var appointmentY = timeStringToY(appointment.begin) + 0.5;
		
		var group = new createjs.Container();
		group.x = x;
		group.y = appointmentY;
		group.mouseChildren = false;
		group.on("pressmove", afspraakVerplaatsen);
		group.on("pressup", afspraakVerplaatst);
		
		var a = new createjs.Shape();
		a.graphics
			.setStrokeStyle(0.5)
			.beginStroke("#5a6d84")
			.beginFill("#C0C0FF")
			.rect(0.5, 0.5, width, timeStringToY(appointment.end) + 0.5 - appointmentY);
		
		var l = new createjs.Text(appointment.activity, "13px Verdana", "#000000");
		l.x = 3;
		l.y = 3;
		l.lineWidth = colWidth - 3;
		l.mask = a;
		
		group.addChild(a, l);
		col.afspraken.push(group);
	}	
	return col;
};

var Label = function Label(width, height, color) {
	self.width = width;
	self.height = height;
	self.color = color;
};

var CalendarOptions = function CalendarOptions(startTime, hours, leftLabel, topLabel) {
	this.startTime = startTime;
	this.hours = hours;
	this.leftLabel = leftLabel;
	this.topLabel = topLabel;
};

var agenda = function(width, height) {
	var stage = new createjs.Stage("c");
	stage.canvas.width = 1280;
	stage.canvas.height = 800;
	return stage;
};

var createColumns = function(items) {
	var columns = [];
	for (var d = 0; d < items.dates.length; d++) {
		var day = items.dates[d];
		for (var col = 0; col < day.resources.length; col++) {
			var resource = day.resources[col];
			columns.push(createColumn(resource, colX, colY, colWidth, 800));
			colX += colWidth;													
		}
	}
	return columns;	
}

/*
   Werkwijze: 
   * laat ruimte over voor de verticale header 
   * begin met het tekenen van alle kolommen: drawColumn()
   * kolommen hebben alleen een *linker* kaderrand
   * teken de verticale header en de rij lijnen. 
   * de verticale header heeft *geen* kaderranden
   * zet de breedte en hoogte van het canvas
   * teken de agenda kaderrand.
*/
// Lezen JSON
var innerX = labelWidth;
var innerY = rowHeight;
var colX = labelWidth + 0.5;
var colY = 2;

var columns = createColumns(items);

var stage = agenda(labelWidth + (columns.length * labelWidth), 800);

// header horizontaal
h = new createjs.Shape();
h.graphics
	.setStrokeStyle(0.5)
	.beginStroke("black")
	.beginFill("#C0A0B0")
	.rect(labelWidth, 0, 1259, rowHeight);
stage.addChild(h);


for (var i = 0; i < columns.length; i++) {
	var col = columns[i];
	stage.addChild(col.header);
	for (var e = 0; e < col.roosters.length; e++) {
		stage.addChild(col.roosters[e]);
	}
	for (var e = 0; e < col.borders.length; e++) {
		stage.addChild(col.borders[e]);
	}
}

// header verticaal
h = new createjs.Shape();
h.graphics
	.setStrokeStyle(0.5)
	.beginStroke("black")
	.beginFill("#C0A0B0")
	.rect(0.5, 0.5, labelWidth, 779);
stage.addChild(h);

// horizontale lijnen (rij scheiding)
for (var i = 0; i < hours.length; i++) {
	var hour = hours[i];
	y = innerY + (rowHeight * i);

	if (hour.officeHours) {
		var background = '#D0B0C0';
	}
	else {
		var background =  '#C0A0B0';
	}
	r = new createjs.Shape();
	r.graphics
		.beginFill(background)
		.rect(0.5, y, labelWidth - 1, rowHeight);
	stage.addChild(r);
	if (!hour.officeHours) {
		r = new createjs.Shape();
		r.graphics
			.beginFill("#D4DCEC")
			.rect(innerX + 1, y, 1189, rowHeight);
		stage.addChild(r);
	}

	var tijd_x = 11.5;
	var tijd_y = y + 4;
	if (Math.floor(hour.time) == hour.time) {
		var tijd = hour.time;
	}
	else {
		var tijd = 30;  // TODO: minuten uitrekenen op basis van fractie (fraction2minute)
	}
	var font_size = 22;
	if (tijd == 30) {
		tijd_x = 44.5;
		tijd_y++;
		font_size = 14;
	}
	if (tijd < 10) {
		tijd_tekst = '0' + tijd;
	}
	else {
		tijd_tekst = '' + tijd;
	}
	var l = new createjs.Text(tijd_tekst, font_size + "px Verdana", "black");
	l.x = tijd_x;
	l.y = tijd_y;
	stage.addChild(l);
	if (tijd != 30) {
		var l = new createjs.Text('00', "14px Verdana", "black");
		l.x = 44.5;
		l.y = ++tijd_y;
		stage.addChild(l);
	}
	var l = new createjs.Shape();
    l.graphics
	.setStrokeStyle(1)
	.beginStroke("black")
	.setStrokeDash([2, 3], 0)
    .moveTo(0, y)
    .lineTo(1270, y)
    .endStroke();
    stage.addChild(l);   		
}

for (var i = 0; i < columns.length; i++) {
	var col = columns[i];
	for (var e = 0; e < col.afspraken.length; e++) {
		stage.addChild(col.afspraken[e]);
	}
}


var kader = new createjs.Shape();
//kader.graphics
//	.setStrokeStyle(0.5)
//	.beginStroke("black")
//	.beginFill("#E0E8F8")
//	.rect(outerX, outerY, 1260, 780);
//stage.addChild(kader);



//// verticale lijnen (kolom scheiding)
//var endFirstColX = outerX + labelWidth + colWidth
//for (var i = 0; i < 20; i++) {
//	var x = endFirstColX + (colWidth * i);
//	var l = new createjs.Shape();
//	l.graphics
//		.setStrokeStyle(0.5)
//		.beginStroke("black")
//		.setStrokeDash([2, 3], 0)
//		.moveTo(x, outerY)
//		.lineTo(x, 790.5)
//		.endStroke();
//	stage.addChild(l);
//}


stage.update();
//-------------------------------------------------------------
